# Optimized CI workflow

name: CI

on:
  push:
    branches: [ "main" ]
    paths-ignore:
      - '*.md'
      - '.gitignore'
      - 'LICENSE'
  pull_request:
    branches: [ "main" ]
    paths-ignore:
      - '*.md'
      - '.gitignore' 
      - 'LICENSE'
  workflow_dispatch:

permissions:
  contents: read

jobs:
  lint-and-validate:
    name: Lint and validate repository
    runs-on: ubuntu-latest
    permissions:
      contents: read
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Validate repository structure
        run: |
          echo "üîç Validating repository structure..."
          
          # Check for required files
          if [ ! -f "README.md" ]; then
            echo "‚ö†Ô∏è  README.md not found"
          else
            echo "‚úÖ README.md found"
          fi
          
          # Validate workflow files
          echo "üîß Validating workflow files..."
          find .github/workflows -name "*.yml" -o -name "*.yaml" | while read -r file; do
            echo "Checking $file..."
            # Add YAML validation here if needed
          done
          
          echo "‚úÖ Repository validation completed"
          
      - name: Security scan
        run: |
          echo "üîí Running basic security checks..."
          
          # Check for secrets or sensitive data
          if grep -r "password\|secret\|token\|key" . --exclude-dir=.git --exclude="*.md" | grep -v "GITHUB_TOKEN"; then
            echo "‚ö†Ô∏è  Potential secrets found in repository"
          else
            echo "‚úÖ No obvious secrets detected"
          fi
          
          echo "Security scan completed"
